<section id="photo-metadata-display" class="row">
  
  <div class="col-sm-9" id="content">
    <button ui-sref="android" class="btn btn-default"><span class="glyphicon glyphicon-menu-left"></span> Back</button>

    <h1>Accessing photo metadata</h1>
    <h2>What we will do</h2>
    <p>In this section, we will display in our app metadata of a photo selected by our user from their Creative Cloud Lightroom library.</p>

    <p>
      Specifically, we will:
      <ol>
        <li>Make a method to handle the result of our Activity</li>
        <li>Store metadata about a selected photo</li>
        <li>Display that metadata in our Activity view</li>
      </ol>
    </p>

    <p class="bg-info bg-padding"><strong>Note:</strong> Make sure you've already implemented user auth as covered in the <a href="#" ui-sref="auth-user">Auth for User section</a>!</p>

    <p class="bg-warning bg-padding"><strong>Warning:</strong> This section will assume that you are already logged in to Creative Cloud from within your app. For more details on how to do that, see the <a href="#" ui-sref="auth-user">Auth for User section</a>.</p>


    <h2>Related documentation for Creative SDK classes</h2>
    <p>In this section, we will use the following Creative SDK classes:</p>
    <ul>
      <li><code></code> (<a href="">documentation</a>)</li>
      <li><code></code> (<a href="">documentation</a>)</li>
      <li><code></code> (<a href="">documentation</a>)</li>
      <li><code></code> (<a href="">documentation</a>)</li>
      <li><code></code> (<a href="">documentation</a>)</li>
    </ul>

    <h2>Making a method to handle the result of our Activity</h2>
    <p>The result of what we do in the <a href="#" ui-sref="asset-browser">Adobe Asset Browser</a> will be handled in a method called <code>onActivityResult()</code>. Let's start by making that method.</p>
    <ol>
      <li>
        <p class="li-header">Creating the <code>onActivityResult()</code> method</p>
        <p>
          In Android Studio's file browser on the left-hand side of the screen, find and double-click on our <code>MainActivity</code> java class to open it.
          <img src="">
        </p>
        <p>
          After our <code>onDestroy()</code> method, let's add an <code>onActivityResult()</code> method:
          <pre>
            <code>
@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    mAuthSessionHelper.onActivityResult(requestCode, resultCode, data);
}              
            </code>
          </pre>
          Note that this method looks very similar to our <code>onXYZ()</code> (like <code>onDestroy()</code>, etc.) methods that we added in an earlier step. There is a call to a method on <code>super</code> and a method on <code>mAuthSessionHelper</code>.
        </p>
      </li>

      <li>
        <p class="li-header">Checking our request code and result code</p>
        <p>
          When <code>onActivityResult()</code> is called, it will be called with 3 arguments: <code>requestCode</code>, <code>resultCode</code>, and <code>data</code>. Let's have a look a the first 2 arguments to conditionally set when we will execute further code.
          <pre>
            <code>
if (requestCode == DEFAULT_SIGN_IN_REQUEST_CODE && resultCode == RESULT_OK) {
}
            </code>
          </pre>  
          For our purposes here, we are only concerning ourselves with the success case.        
        </p>
      </li>

      <li>
        <p class="li-header">Preparing to log a result</p>
        <p>
          Before we get access to an Adobe Photo Asset, let's get set up to log results so we can check to make sure we're on track.
        </p>
        <p>
          At the very top of our <code>MainActivity</code> class, make a <code>TAG</code> varible set to the name of our Activity:
          <pre>
            <code>
public class MainActivity extends AppCompatActivity {            
    public static final String TAG = MainActivity.class.getSimpleName();  
...              
            </code>
          </pre>          
        </p>
        <p>
          Next, go back down to <code>onActivityResult()</code> and add a very simple log:
          <pre>
            <code>
Log.i(TAG, "Result success!");
            </code>
          </pre>
          Try it out: 
          <ol>
            <li>Build and run your app.</li>
            <li>Launch the Asset Browser.</li>
            <li>Navigate through the browser, choose a photo, and click open.</li>
            <li>
              <p>In Android Studio, look at your Android Logs for "Result success!" (you may need to search for it).
                <img src="">
              </p>
            </li>
          </ol>
        </p>
      </li>
    </ol>
    
    <h2>Getting a selected Adobe Photo Asset</h2>
    <ol>        
      <li>
        <p class="li-header">Create a variable for our Adobe Photo Asset</p>
        <p>
          Within our if block, let's create a variable that is assigned to the return value of a method we will create in the following steps:
          <pre>
            <code>
if (requestCode == DEFAULT_SIGN_IN_REQUEST_CODE && resultCode == RESULT_OK) {
    <strong>final AdobePhotoAsset mPhotoAsset = getPhotoAsset(data);</strong>

    Log.i(TAG, "Result success!");
}            
            </code>
          </pre>
          We pass our <code>data</code> argument to this method so we can work with the data to get the Adobe Photo Asset contained within.           
        </p>
      </li>    
      <li>
        <p class="li-header">Create a <code>getPhotoAsset()</code> method</p>
        <p>
          Below <code>onActivityResult()</code>, let's create the new method:
          <pre>
            <code>
public AdobePhotoAsset getPhotoAsset(Intent data) {
};            
            </code>
          </pre>          
        </p>
      </li>
      <li>
        <p class="li-header">Unpacking the Adobe Photo Asset from <code>data</code> in 4 steps</p>
        <p>
          In our <code>getPhotoAsset</code> method, we will add the following code to gain access to our Adobe Photo Asset:
          <pre>
            <code>
public AdobePhotoAsset getPhotoAsset(Intent data) {
    <strong>AdobeUXAssetBrowser.ResultProvider mAssetBrowserResult = new AdobeUXAssetBrowser.ResultProvider(data);
    ArrayList mListOfSelectedAssetFiles = mAssetBrowserResult.getSelectionAssetArray();
    AdobeSelectionPhotoAsset mAsset = (AdobeSelectionPhotoAsset)mListOfSelectedAssetFiles.get(0);
    return mAsset.getSelectedItem();</strong>
};            
            </code>
          </pre>
          The steps we have taken are as follows:
          <ol>
            <li>Construct a new Result Provider object, passing in <code>data</code> as our argument</li>
            <li>Get the array of assets contained in our Result Provider object</li>
            <li>Get the first item of the array, which is an Adobe Selection Photo Asset</li>
            <li>Get and return the selected item from this Selection Photo Asset, which is an Adobe Photo Asset</li>
          </ol>          
        </p>
      </li>
      <li>
        <p class="li-header">Log the name of the Photo Asset</p>
        <p>
          To see if things are working let's try logging the name of our Photo Asset from the if block in <code>onActivityResult()</code>.
          <pre>
            <code>
if (requestCode == DEFAULT_SIGN_IN_REQUEST_CODE && resultCode == RESULT_OK) {
    final AdobePhotoAsset mPhotoAsset = getPhotoAsset(data);

    Log.i(TAG, <strong>"Result success! " + mPhotoAsset.getName()</strong>);
}
            </code>
          </pre>                  
        </p>
      </li>                 
    </ol>

    <h2>Review your code</h2>
    <p>We've added two methods to our <code>MainActivity</code> java class: <code>onActivityResult()</code> and <code>getPhotoAsset()</code>.</p>
    <pre>
      <code>
@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    mAuthSessionHelper.onActivityResult(requestCode, resultCode, data);

    if (requestCode == DEFAULT_SIGN_IN_REQUEST_CODE && resultCode == RESULT_OK) {
        final AdobePhotoAsset mPhotoAsset = getPhotoAsset(data);

        Log.i(TAG, "Result success! " + mPhotoAsset.getName());
    }
}

public AdobePhotoAsset getPhotoAsset(Intent data) {
    AdobeUXAssetBrowser.ResultProvider mAssetBrowserResult = new AdobeUXAssetBrowser.ResultProvider(data);
    ArrayList mListOfSelectedAssetFiles = mAssetBrowserResult.getSelectionAssetArray();
    AdobeSelectionPhotoAsset mAsset = (AdobeSelectionPhotoAsset)mListOfSelectedAssetFiles.get(0);
    return mAsset.getSelectedItem();
};      
      </code>
    </pre>

    <h2>Build and run the app</h2>
    <p>
      Just as we did in the <a href="#" ui-sref="getting-started">Getting Started section</a>, go ahead and give the app a spin. We will assume you have already logged in to Creative Cloud with your Adobe ID, as we did in the <a href="#" ui-sref="auth-user">Auth for User section</a>.
    </p>

    <ol>

      <li>
        <p class="li-header">The Main Activity view</p>
        <p>
          You should see this screen if you are logged in:
          <img src="">
        </p>
      </li>

      <li>
        <p class="li-header">The Adobe Asset Browser</p>
        <p>
          Just click the button to launch the Adobe Asset Browser!
          <img src="">   
        </p>
      </li>

      <li>
        <p class="li-header">Open a photo</p>
        <p>
          Navigate through the browser, choose a photo, and click open.
          <img src="">
        </p>
      </li>

      <li>
        <p class="li-header">Look at your logs</p>
        <p>
          In Android Studio, look at your Android Logs for "Result success! {YOUR_PHOTO_NAME.jpg}" (you may need to search for it).
          <img src="">
        </p>
      </li>              

    </ol>
    
    <button ui-sref="android" class="btn btn-default"><span class="glyphicon glyphicon-menu-left"></span> Back</button>
  </div>

</section>